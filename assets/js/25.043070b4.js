(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{190:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),a("p",[t._v("webpack 先简单说一下！webpack 本就是分块打包，所以不用过多注意。（JS 引入了相同的库和模块，这时候将公共的库抽成一个 JS 文件，就用 CommonsChunkPlugin）")]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),a("p",[t._v("其实在 router 中就已经使用了！")]),t._v(" "),t._m(6),t._v(" "),a("p",[t._v("修改完成后打包，就可以看到效果；")]),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),a("p",[t._v("骨架屏就很简单了，按照使用页面的结果编写就 ok 了；")]),t._v(" "),a("p",[t._v("有个插件："),a("a",{attrs:{href:"https://github.com/egoist/vue-content-loader",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-content-loader"),a("OutboundLink")],1),t._v(" 也可以在线编辑骨架屏；")]),t._v(" "),a("p",[t._v("但当前项目用了 ssr，首屏的骨架屏就鸡肋了！so 我就在第二屏及以后加上了骨架屏，而第三屏正好是一张特别大的详情图片，关键设计没有切成若干小图，是一大张，长，长长，长长长的详情图片！严重影响了页面的 loading 速度")]),t._v(" "),t._m(11),t._v(" "),a("p",[t._v("懒加载做了一个组件，而代码是直接拿 vue-lazy-component 组件的；方便修改和调试；")]),t._v(" "),t._m(12),t._v(" "),t._m(13),t._m(14),t._v(" "),t._m(15)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("着手优化我最先想到的是，打包，加载，速度，渲染，用户体验；所以我的也从这几个词开始入手。本次优化主要做了三件事，代码（vue），懒加载，骨架屏；还有很多会继续做。。。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码","aria-hidden":"true"}},[this._v("#")]),this._v(" 代码")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"打包-webpack"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#打包-webpack","aria-hidden":"true"}},[this._v("#")]),this._v(" 打包 webpack")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("现在虽然开发是按照模块化开发，webpack 也是遵循的模块打包的，但是打包是按照模块打包了吗？")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("p",[t._v("上代码！！！优化前")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2018/12/6/16782a1d37a1b329?w=342&h=261&f=png&s=24169",alt:""}})]),t._v(" "),a("p",[t._v("由于平时的不注意，代码中大量的组件引用都是用这种方式；")]),t._v(" "),a("p",[t._v("可这样就导致了首屏展示或第一次加载中，不用的组件也打包到了入口 js 中（app.js）;得到的结果就是首屏 js 越来越大，加载时间也就长了；")])]),t._v(" "),a("li",[a("p",[t._v("优化")]),t._v(" "),a("p",[t._v("很简单，改成异步就好；")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2018/12/6/16782adb86faaa40?w=438&h=291&f=png&s=29059",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2018/12/6/16782b018ca86256?w=573&h=183&f=png&s=26062",alt:""}})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ol",[a("li",[a("p",[t._v("js 文件明显增加了")])]),t._v(" "),a("li",[a("p",[t._v("页面中 head 标签中 同样增加了 js 引入；")])]),t._v(" "),a("li",[a("p",[t._v("这里需要注意的是 js 引入放到 head 中会不会影响优化？其实不会的，因为引入的 script 标签中加了 async 属性使其变成了异步；")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2018/12/6/16782b28a7be3c41?w=1590&h=1634&f=png&s=564645",alt:""}})]),t._v(" "),a("p",[t._v("head 标签")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2018/12/6/16782bbb1a866ebc?w=570&h=162&f=png&s=66336",alt:""}})])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"代码-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码-2","aria-hidden":"true"}},[this._v("#")]),this._v(" 代码")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("增加了 v-if 的使用，特别是针对所有不是频繁切换组件和 dom；而这么做是因为 v-if 和 v-show 的区别；v-if 是“true”条件渲染，v-show 是什么条件都渲染")]),this._v(" "),s("li",[this._v("组件异步加载，也就打包部分的讲到的；但是判断组件是否异步，就需要根据首屏展示的 dom 结构自行选择，不是所有组件适合异步加载；")]),this._v(" "),s("li",[this._v("为了评分也在图片上，加上 alt 的默认参数；")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"骨架屏"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#骨架屏","aria-hidden":"true"}},[this._v("#")]),this._v(" 骨架屏")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"懒加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#懒加载","aria-hidden":"true"}},[this._v("#")]),this._v(" 懒加载")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("p",[this._v("vue-lazy-component 代码")]),this._v(" "),s("p",[this._v("主要用了原生的 IntersectionObserver（交叉观察器）构造函数；")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" io "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("IntersectionObserver")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" option"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("p",[this._v("IntersectionObserver 函数")]),this._v(" "),s("p",[this._v("解释：监听目标元素与视口产生一个交叉区")]),this._v(" "),s("p",[this._v("介绍直接代码")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" io "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("null")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("// 回调函数")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),a("span",{attrs:{class:"token function-variable function"}},[t._v("callback")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entries"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 正在交叉")]),t._v("\n        entries"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isIntersecting "),a("span",{attrs:{class:"token operator"}},[t._v("||")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 交叉率大于0")]),t._v("\n        entries"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("intersectionRatio\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("// 在组件销毁前取消观察-销毁方法")]),t._v("\n        io"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("unobserve")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$el"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("// 观察视口与组件容器的交叉情况")]),t._v("\nio "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("window"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IntersectionObserver")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("// 容器窗口，滚动的父元素")]),t._v("\n    root"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("viewport"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("// 可以在父级（root）影响范围 扩展或缩小，类似css的margin～")]),t._v("\n    rootMargin"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("// 触发回调的位置，“%”单位， [0, 0.25, 0.5, 0.75, 1]就表示当目标元素 0%、25%、50%、75%、100% 可见时，会触发回调函数。")]),t._v("\n    threshold"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Number"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token constant"}},[t._v("MIN_VALUE")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0.01")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("// 观察对象-挂载方法")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("observe")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$el"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br")])])}],!1,null,null,null);e.options.__file="optimize.md";s.default=e.exports}}]);